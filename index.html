<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Gerencial – Saúde da Rede de Internet</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .slide {
            transition: opacity 0.5s ease-in-out;
        }
        .slide-hidden {
            display: none;
        }
        /* Simple chart styles */
        .pie-chart {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            /* Os valores serão atualizados via JS se necessário, por agora é visual */
            background-image: conic-gradient(
                #ef4444 0% 20%,   /* Alta (vermelho) */
                #f59e0b 20% 60%,  /* Média (amarelo) */
                #6b7280 60% 100% /* Baixa (cinza) */
            );
        }
        .gauge-chart {
            width: 150px;
            height: 75px;
            border-top-left-radius: 150px;
            border-top-right-radius: 150px;
            background: conic-gradient(from -90deg at 50% 100%, #10B981 0%, #10B981 99.8%, #E5E7EB 99.8%, #E5E7EB 100%);
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex flex-col items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-4xl bg-gray-800 rounded-lg shadow-2xl overflow-hidden">
        <!-- Presentation Slides Container -->
        <div id="presentation-container" class="relative p-8 md:p-12 min-h-[500px]">
            
            <!-- Slide 0: Capa / Menu Interativo -->
            <div class="slide" data-slide-id="capa">
                <div class="text-center flex flex-col justify-center items-center h-full min-h-[450px]">
                    <h1 class="text-4xl font-bold text-cyan-400 mb-4">Book Gerencial – Saúde da Rede</h1>
                    <p class="text-lg text-gray-300 mb-6">Relatório interativo de performance e segurança da rede.</p>
                    <div id="date-time-container" class="mb-6 text-center">
                        <p id="date" class="text-lg text-gray-400"></p>
                        <p id="time" class="text-2xl font-bold text-gray-200"></p>
                    </div>
                    <h2 class="text-xl font-semibold text-cyan-400 mb-4">Navegar para:</h2>
                    <nav>
                        <ul class="grid grid-cols-2 md:grid-cols-4 gap-3">
                            <li><a href="#" class="menu-link block bg-gray-700 hover:bg-cyan-700 text-white font-semibold py-2 px-4 rounded-lg text-center transition-colors" data-slide="1">Resumo</a></li>
                            <li><a href="#" class="menu-link block bg-gray-700 hover:bg-cyan-700 text-white font-semibold py-2 px-4 rounded-lg text-center transition-colors" data-slide="2">KPIs</a></li>
                            <li><a href="#" class="menu-link block bg-gray-700 hover:bg-cyan-700 text-white font-semibold py-2 px-4 rounded-lg text-center transition-colors" data-slide="3">Incidentes</a></li>
                            <li><a href="#" class="menu-link block bg-gray-700 hover:bg-cyan-700 text-white font-semibold py-2 px-4 rounded-lg text-center transition-colors" data-slide="4">Monitoramento</a></li>
                            <li><a href="#" class="menu-link block bg-gray-700 hover:bg-cyan-700 text-white font-semibold py-2 px-4 rounded-lg text-center transition-colors" data-slide="5">Segurança</a></li>
                            <li><a href="#" class="menu-link block bg-gray-700 hover:bg-cyan-700 text-white font-semibold py-2 px-4 rounded-lg text-center transition-colors" data-slide="6">Histórico</a></li>
                            <li><a href="#" class="menu-link block bg-gray-700 hover:bg-cyan-700 text-white font-semibold py-2 px-4 rounded-lg text-center transition-colors" data-slide="7">Ações</a></li>
                            <li><a href="#" class="menu-link block bg-gray-700 hover:bg-cyan-700 text-white font-semibold py-2 px-4 rounded-lg text-center transition-colors" data-slide="8">Recomendações</a></li>
                        </ul>
                    </nav>
                </div>
            </div>

            <!-- Slide 1: Resumo Executivo -->
            <div class="slide slide-hidden" data-slide-id="resumo">
                <h1 class="text-3xl font-bold text-cyan-400 mb-2">1. Resumo Executivo</h1>
                <h2 id="resumo-subtitulo" class="text-xl font-semibold text-gray-300 mb-6"></h2>
                <ul id="resumo-lista" class="space-y-4 text-lg"></ul>
            </div>

            <!-- Slide 2: Indicadores de Desempenho -->
            <div class="slide slide-hidden" data-slide-id="kpis">
                <h1 class="text-3xl font-bold text-cyan-400 mb-6">2. Indicadores de Desempenho (KPIs)</h1>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-gray-700/50 p-4 rounded-lg text-center">
                        <h3 class="font-semibold mb-2">Disponibilidade da Rede (% Uptime)</h3>
                        <div id="kpi-disponibilidade-grafico" class="relative mx-auto gauge-chart"></div>
                        <p id="kpi-disponibilidade-valor" class="text-4xl font-bold mt-2"></p>
                        <p id="kpi-disponibilidade-meta" class="text-green-400"></p>
                    </div>
                    <div class="bg-gray-700/50 p-4 rounded-lg text-center">
                        <h3 class="font-semibold mb-2">Latência Média (ms)</h3>
                        <p id="kpi-latencia-valor" class="text-4xl font-bold mt-10"></p>
                        <p id="kpi-latencia-meta" class="text-green-400"></p>
                    </div>
                    <div class="bg-gray-700/50 p-4 rounded-lg">
                        <h3 class="font-semibold mb-2 text-center">Velocidade (Download/Upload)</h3>
                        <div class="flex justify-around items-end h-32 mt-4">
                            <div class="text-center"><div id="kpi-velocidade-download-grafico" class="w-12 bg-cyan-500 rounded-t-sm"></div><p id="kpi-velocidade-download-valor" class="text-sm mt-1"></p></div>
                            <div class="text-center"><div class="w-12 bg-gray-500 rounded-t-sm" style="height: 100%;"></div><p id="kpi-velocidade-download-meta" class="text-sm mt-1"></p></div>
                            <div class="text-center"><div id="kpi-velocidade-upload-grafico" class="w-12 bg-purple-500 rounded-t-sm"></div><p id="kpi-velocidade-upload-valor" class="text-sm mt-1"></p></div>
                            <div class="text-center"><div class="w-12 bg-gray-500 rounded-t-sm" style="height: 100%;"></div><p id="kpi-velocidade-upload-meta" class="text-sm mt-1"></p></div>
                        </div>
                        <div class="flex justify-around text-xs mt-2"><span>Down</span><span class="text-gray-400">Cont.</span><span>Up</span><span class="text-gray-400">Cont.</span></div>
                    </div>
                    <div class="bg-gray-700/50 p-4 rounded-lg text-center">
                        <h3 class="font-semibold mb-2">Taxa de Perda de Pacotes</h3>
                        <p id="kpi-perda-valor" class="text-4xl font-bold mt-10"></p>
                        <p id="kpi-perda-meta" class="text-green-400"></p>
                    </div>
                </div>
            </div>

            <!-- Slide 3: Incidentes e Ocorrências -->
            <div class="slide slide-hidden" data-slide-id="incidentes">
                <h1 class="text-3xl font-bold text-cyan-400 mb-6">3. Incidentes e Ocorrências</h1>
                <div class="flex flex-col md:flex-row gap-8">
                    <div class="flex-1 space-y-4">
                        <div class="bg-gray-700/50 p-4 rounded-lg"><p class="text-gray-400">Total de Incidentes</p><p id="incidentes-total" class="text-3xl font-bold"></p></div>
                        <div class="bg-gray-700/50 p-4 rounded-lg"><p class="text-gray-400">Tempo Médio para Resolução (MTTR)</p><p id="incidentes-mttr" class="text-3xl font-bold"></p></div>
                    </div>
                    <div class="flex-1 bg-gray-700/50 p-4 rounded-lg">
                        <h3 class="font-semibold text-center mb-4">Classificação por Criticidade</h3>
                        <div class="flex items-center justify-center gap-6">
                            <div id="incidentes-grafico" class="pie-chart"></div>
                            <ul id="incidentes-lista" class="space-y-2"></ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Slide 4: Monitoramento em Tempo Real -->
            <div class="slide slide-hidden" data-slide-id="monitoramento">
                <h1 class="text-3xl font-bold text-cyan-400 mb-6">4. Monitoramento em Tempo Real</h1>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="font-semibold mb-2">Gráfico de Tráfego por Horário</h3>
                        <div class="bg-gray-700/50 p-4 rounded-lg"><img id="monitoramento-grafico" src="" alt="Gráfico de Tráfego" class="rounded-md w-full"><p id="monitoramento-pico" class="text-center mt-2 text-sm text-gray-400"></p></div>
                    </div>
                    <div><h3 class="font-semibold mb-2">Alertas Recentes</h3><div id="monitoramento-alertas" class="bg-gray-700/50 p-4 rounded-lg space-y-3"></div></div>
                </div>
            </div>

             <!-- Slide 5: Segurança da Rede -->
            <div class="slide slide-hidden" data-slide-id="seguranca">
                <h1 class="text-3xl font-bold text-cyan-400 mb-6">5. Segurança da Rede</h1>
                <h3 class="font-semibold mb-2">Tentativas de Acesso Não Autorizado Bloqueadas: <span id="seguranca-tentativas" class="text-xl text-red-400"></span></h3>
                <div class="my-4 p-4 bg-gray-700/50 rounded-lg"><img id="seguranca-mapa" src="" alt="Mapa de Ameaças" class="rounded-md w-full"></div>
                <h3 class="font-semibold mb-2 mt-6">Status das Ferramentas de Segurança:</h3>
                <ul id="seguranca-ferramentas" class="space-y-2 text-lg"></ul>
            </div>

            <!-- Slide 6: Comparativo Histórico -->
            <div class="slide slide-hidden" data-slide-id="historico">
                <h1 class="text-3xl font-bold text-cyan-400 mb-6">6. Comparativo Histórico</h1>
                <p class="mb-4 text-gray-300">Evolução da performance nos últimos 6 meses.</p>
                <div class="overflow-x-auto">
                    <table class="w-full text-left border-collapse">
                        <thead id="historico-cabecalho"></thead>
                        <tbody id="historico-corpo" class="bg-gray-800"></tbody>
                    </table>
                </div>
                 <p id="historico-tendencia" class="mt-4 text-center font-semibold text-green-300"></p>
            </div>

            <!-- Slide 7: Ações Corretivas e Preventivas -->
            <div class="slide slide-hidden" data-slide-id="acoes">
                <h1 class="text-3xl font-bold text-cyan-400 mb-6">7. Ações Corretivas e Preventivas</h1>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div><h3 class="font-semibold text-lg mb-2">Ações Realizadas</h3><ul id="acoes-realizadas" class="space-y-3"></ul></div>
                    <div><h3 class="font-semibold text-lg mb-2">Plano de Ação Futuro</h3><ul id="acoes-futuras" class="space-y-3"></ul></div>
                </div>
            </div>

            <!-- Slide 8: Recomendações Técnicas -->
            <div class="slide slide-hidden" data-slide-id="recomendacoes">
                <h1 class="text-3xl font-bold text-cyan-400 mb-6">8. Recomendações Técnicas</h1>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div><h3 class="font-semibold text-lg mb-2">Sugestões para Melhoria</h3><ul id="recomendacoes-melhorias" class="space-y-3"></ul></div>
                    <div><h3 class="font-semibold text-lg mb-2">Investimentos Necessários</h3><ul id="recomendacoes-investimentos" class="space-y-3"></ul></div>
                </div>
            </div>

        </div>

        <!-- Navigation -->
        <div id="navigation-bar" class="bg-gray-900 p-4 flex justify-between items-center border-t border-gray-700">
            <button id="homeBtn" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg">Menu</button>
            <button id="prevBtn" class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-lg">Anterior</button>
            <button id="downloadBtn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg">Download PPTX</button>
            <div id="slide-counter" class="text-sm text-gray-400"></div>
            <button id="nextBtn" class="bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded-lg">Próximo</button>
        </div>
    </div>

    <script>
        // ===================================================================================
        // DADOS DA APRESENTAÇÃO - EDITE APENAS ESTA SEÇÃO PARA ATUALIZAR O CONTEÚDO
        // ===================================================================================
        const dadosDaApresentacao = {
            resumo: {
                subtitulo: "Visão Geral da Saúde da Rede – Setembro/2025", // Altere aqui o mês e ano
                pontos: [
                    { titulo: "Performance Geral", texto: "A rede operou com alta estabilidade durante o período, mantendo os principais indicadores dentro dos limites esperados." },
                    { titulo: "Destaques Positivos", texto: "Implementação do novo link de fibra resultou em uma redução de 20% na latência média." },
                    { titulo: "Pontos de Atenção", texto: "Registramos 3 incidentes de lentidão no período da tarde, associados ao pico de uso." },
                    { titulo: "Conclusão", texto: `A saúde da rede é considerada <span class="bg-green-500/20 text-green-300 px-2 py-1 rounded">Boa</span>. Ações preventivas estão em andamento.` }
                ]
            },
            kpis: {
                disponibilidade: { valor: "99,8%", meta: "Meta: > 99.5%" },
                latencia: { valor: "15 ms", meta: "Meta: < 20 ms" },
                velocidade: {
                    download: { valor: "480 Mbps", meta: "500 Mbps", percentualContratado: 96 },
                    upload: { valor: "245 Mbps", meta: "250 Mbps", percentualContratado: 98 }
                },
                perdaPacotes: { valor: "0.02%", meta: "Meta: < 0.1%" }
            },
            incidentes: {
                total: 5,
                mttr: "45 minutos",
                criticidade: [
                    { nivel: "Alta", valor: 1, cor: "red-500" },
                    { nivel: "Média", valor: 2, cor: "yellow-500" },
                    { nivel: "Baixa", valor: 2, cor: "gray-500" }
                ]
            },
            monitoramento: {
                graficoUrl: "https://placehold.co/600x250/1F2937/FFFFFF?text=Gráfico+de+Tráfego",
                pico: "Pico de consumo identificado: 15:00h - 17:00h",
                alertas: [
                    { nivel: "MÉDIO", texto: "14:30 - CPU do Firewall atingiu 75%.", cor: "yellow-500" },
                    { nivel: "ALTO", texto: "10:15 - Múltiplas tentativas de login falhas.", cor: "red-500" },
                    { nivel: "OK", texto: "09:00 - Sistema operando normalmente.", cor: "green-500" }
                ]
            },
            seguranca: {
                tentativasBloqueadas: "1.250",
                mapaAmeacasUrl: "https://placehold.co/800x200/1F2937/FFFFFF?text=Mapa+de+Ameaças",
                ferramentas: [
                    "Firewall: Firmware atualizado.",
                    "Antivírus (Endpoints): 100% dos dispositivos atualizados.",
                    "VPNs e Conexões Seguras: Todas as conexões ativas e criptografadas."
                ]
            },
            historico: {
                cabecalho: ["Mês", "Disponibilidade (%)", "Latência Média (ms)", "Incidentes Críticos"],
                linhas: [
                    ["[Mês-6]", "99,7%", "25", "3"],
                    ["[Mês-5]", "99,6%", "22", "2"],
                    ["[Mês-4]", "99,9%", "18", "1"],
                    ["[Mês-3]", "99,8%", "19", "1"],
                    ["[Mês-2]", "99,9%", "16", "0"],
                    ["[Mês-1]", "99,8%", "15", "1"] // Última linha é destacada
                ],
                tendencia: "Tendência Geral: Melhoria Contínua"
            },
            acoes: {
                realizadas: [
                    { estado: "CONCLUÍDO", texto: "Upgrade do Switch Central.", cor: "green-400" },
                    { estado: "CONCLUÍDO", texto: "Balanceamento de Carga.", cor: "green-400" },
                    { estado: "CONCLUÍDO", texto: "Atualização do Firmware do Firewall.", cor: "green-400" },
                ],
                futuras: [
                    { estado: "EM ANDAMENTO", texto: "Segmentação da Rede Wi-Fi.", cor: "yellow-400" },
                    { estado: "PLANEJADO", texto: "Contratação de Link de Redundância (Q4).", cor: "blue-400" },
                ]
            },
            recomendacoes: {
                melhorias: [
                    "<strong>Implementar QoS (Quality of Service):</strong> Priorizar tráfego crítico.",
                    "<strong>Monitoramento de Aplicações:</strong> Identificar consumo de banda por app."
                ],
                investimentos: [
                    "<strong>Aquisição de Access Points Wi-Fi 6:</strong> Melhorar cobertura e velocidade.",
                    "<strong>Licença de Software de Análise de Tráfego.</strong>"
                ]
            }
        };
        // ===================================================================================
        // FIM DA SEÇÃO DE DADOS
        // ===================================================================================

        // --- LÓGICA DE RENDERIZAÇÃO E NAVEGAÇÃO ---
        const slides = document.querySelectorAll('.slide');
        const homeBtn = document.getElementById('homeBtn');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const slideCounter = document.getElementById('slide-counter');
        const downloadBtn = document.getElementById('downloadBtn');
        const navigationBar = document.getElementById('navigation-bar');
        const menuLinks = document.querySelectorAll('.menu-link');
        let currentSlide = 0;
        const totalSlides = slides.length;

        function renderSlide(index) {
            const slideId = slides[index].dataset.slideId;
            const dados = dadosDaApresentacao;

            switch (slideId) {
                case 'resumo':
                    document.getElementById('resumo-subtitulo').textContent = dados.resumo.subtitulo;
                    document.getElementById('resumo-lista').innerHTML = dados.resumo.pontos.map(p => 
                        `<li class="flex items-start"><span class="text-cyan-400 mr-3 mt-1">▶</span><div><strong class="font-semibold">${p.titulo}:</strong> ${p.texto}</div></li>`
                    ).join('');
                    break;
                case 'kpis':
                    document.getElementById('kpi-disponibilidade-valor').textContent = dados.kpis.disponibilidade.valor;
                    document.getElementById('kpi-disponibilidade-meta').textContent = dados.kpis.disponibilidade.meta;
                    document.getElementById('kpi-latencia-valor').textContent = dados.kpis.latencia.valor;
                    document.getElementById('kpi-latencia-meta').textContent = dados.kpis.latencia.meta;
                    document.getElementById('kpi-velocidade-download-valor').textContent = dados.kpis.velocidade.download.valor;
                    document.getElementById('kpi-velocidade-download-meta').textContent = dados.kpis.velocidade.download.meta;
                    document.getElementById('kpi-velocidade-download-grafico').style.height = `${dados.kpis.velocidade.download.percentualContratado}%`;
                    document.getElementById('kpi-velocidade-upload-valor').textContent = dados.kpis.velocidade.upload.valor;
                    document.getElementById('kpi-velocidade-upload-meta').textContent = dados.kpis.velocidade.upload.meta;
                    document.getElementById('kpi-velocidade-upload-grafico').style.height = `${dados.kpis.velocidade.upload.percentualContratado}%`;
                    document.getElementById('kpi-perda-valor').textContent = dados.kpis.perdaPacotes.valor;
                    document.getElementById('kpi-perda-meta').textContent = dados.kpis.perdaPacotes.meta;
                    break;
                case 'incidentes':
                    document.getElementById('incidentes-total').textContent = dados.incidentes.total;
                    document.getElementById('incidentes-mttr').textContent = dados.incidentes.mttr;
                    document.getElementById('incidentes-lista').innerHTML = dados.incidentes.criticidade.map(c => 
                        `<li><span class="inline-block w-3 h-3 bg-${c.cor} rounded-full mr-2"></span>${c.nivel}: ${c.valor}</li>`
                    ).join('');
                    break;
                case 'monitoramento':
                    document.getElementById('monitoramento-grafico').src = dados.monitoramento.graficoUrl;
                    document.getElementById('monitoramento-pico').textContent = dados.monitoramento.pico;
                    document.getElementById('monitoramento-alertas').innerHTML = dados.monitoramento.alertas.map(a =>
                        `<div class="flex items-center"><span class="w-3 h-3 rounded-full bg-${a.cor} mr-3 flex-shrink-0"></span>[ALERTA ${a.nivel}] ${a.texto}</div>`
                    ).join('');
                    break;
                case 'seguranca':
                    document.getElementById('seguranca-tentativas').textContent = dados.seguranca.tentativasBloqueadas;
                    document.getElementById('seguranca-mapa').src = dados.seguranca.mapaAmeacasUrl;
                    document.getElementById('seguranca-ferramentas').innerHTML = dados.seguranca.ferramentas.map(f =>
                        `<li class="flex items-center"><span class="text-green-400 mr-2">✔</span>${f}</li>`
                    ).join('');
                    break;
                case 'historico':
                    document.getElementById('historico-cabecalho').innerHTML = `<tr>${dados.historico.cabecalho.map(h => `<th class="p-3 text-center">${h}</th>`).join('')}</tr>`;
                    document.getElementById('historico-corpo').innerHTML = dados.historico.linhas.map((linha, i) => {
                        const isLast = i === dados.historico.linhas.length - 1;
                        const rowClass = isLast ? 'bg-cyan-900/30 font-bold' : 'border-b border-gray-700';
                        return `<tr class="${rowClass}">${linha.map(cell => `<td class="p-3 text-center">${cell}</td>`).join('')}</tr>`;
                    }).join('');
                    document.getElementById('historico-tendencia').textContent = dados.historico.tendencia;
                    break;
                case 'acoes':
                    document.getElementById('acoes-realizadas').innerHTML = dados.acoes.realizadas.map(a => `<li class="bg-gray-700/50 p-3 rounded-lg"><span class="font-bold text-${a.cor}">[${a.estado}]</span> ${a.texto}</li>`).join('');
                    document.getElementById('acoes-futuras').innerHTML = dados.acoes.futuras.map(a => `<li class="bg-gray-700/50 p-3 rounded-lg"><span class="font-bold text-${a.cor}">[${a.estado}]</span> ${a.texto}</li>`).join('');
                    break;
                case 'recomendacoes':
                     document.getElementById('recomendacoes-melhorias').innerHTML = dados.recomendacoes.melhorias.map(item => `<li class="bg-gray-700/50 p-3 rounded-lg">${item}</li>`).join('');
                     document.getElementById('recomendacoes-investimentos').innerHTML = dados.recomendacoes.investimentos.map(item => `<li class="bg-gray-700/50 p-3 rounded-lg">${item}</li>`).join('');
                    break;
            }
        }

        function showSlide(index) {
            slides.forEach((slide, i) => { slide.style.display = (i === index) ? 'block' : 'none'; });
            if (index === 0) {
                navigationBar.style.display = 'none';
            } else {
                navigationBar.style.display = 'flex';
                slideCounter.textContent = `Slide ${index} de ${totalSlides - 1}`;
                prevBtn.disabled = index === 1;
                nextBtn.disabled = index === totalSlides - 1;
                renderSlide(index);
            }
            currentSlide = index;
        }

        homeBtn.addEventListener('click', () => showSlide(0));
        prevBtn.addEventListener('click', () => { if (currentSlide > 1) showSlide(currentSlide - 1); });
        nextBtn.addEventListener('click', () => { if (currentSlide < totalSlides - 1) showSlide(currentSlide + 1); });
        menuLinks.forEach(link => {
            link.addEventListener('click', (e) => { e.preventDefault(); showSlide(parseInt(link.dataset.slide, 10)); });
        });

        function updateDateTime() {
            const dateEl = document.getElementById('date'), timeEl = document.getElementById('time');
            if (!dateEl || !timeEl) return;
            const now = new Date();
            dateEl.textContent = now.toLocaleDateString('pt-BR', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            timeEl.textContent = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        }
        
        let pptxLibraryLoaded = false;
        function generatePptx() {
            try {
                let pptx = new PptxGenJS();
                pptx.layout = 'LAYOUT_WIDE';
                const titleOpts = { x: 0.5, y: 0.25, w: 9, h: 0.75, fontSize: 32, fontFace: 'Inter', color: '00A6A6', bold: true };
                
                // Gerar slides a partir dos dados
                // ... (A lógica de geração do PPTX também usaria o objeto `dadosDaApresentacao`)

                pptx.writeFile({ fileName: 'Apresentacao_Saude_Rede.pptx' });
                downloadBtn.disabled = false;
                downloadBtn.textContent = 'Download PPTX';
            } catch (err) {
                console.error("Erro ao gerar PPTX:", err);
                downloadBtn.textContent = 'Erro!';
                setTimeout(() => { downloadBtn.disabled = false; downloadBtn.textContent = 'Download PPTX'; }, 3000);
            }
        }
        
        function loadPptxLibraryAndGenerate() {
            downloadBtn.disabled = true;
            downloadBtn.textContent = 'A preparar...';
            if (pptxLibraryLoaded) { generatePptx(); return; }
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js';
            script.onload = () => { pptxLibraryLoaded = true; downloadBtn.textContent = 'A gerar...'; generatePptx(); };
            script.onerror = () => {
                console.error('Falha ao carregar a biblioteca PptxGenJS.');
                downloadBtn.textContent = 'Falha';
                setTimeout(() => { downloadBtn.disabled = false; downloadBtn.textContent = 'Tentar Novamente'; }, 3000);
            };
            document.head.appendChild(script);
        }
        downloadBtn.addEventListener('click', loadPptxLibraryAndGenerate);

        showSlide(currentSlide);
        updateDateTime();
        setInterval(updateDateTime, 1000);
    </script>

</body>
</html>

